<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="Img/Mpn.ico" type="image/x-icon" /> 
  <title>Mahapala Narotama</title>
  <meta name="description" content="Mahapala Narotama Surabaya adalah organisasi pecinta alam yang aktif dalam kegiatan outdoor, mountaineering, dan panjat tebing.">
  <meta name="keywords" content="Mahapala, Mahapala Narotama, Pecinta Alam Surabaya, Panjat Tebing Surabaya, UKM Pecinta Alam, Outdoor Adventure">
  <meta name="author" content="Mahapala Narotama Surabaya">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://mahapalanarotama.web.id/">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Gaya dasar untuk seluruh website */
    body {
      font-family: 'Arial', sans-serif;
      line-height: 1.6;
      scroll-behavior: smooth;
      background-color: #f8f9fa;
    }
    section {
      padding-top: 80px;
      padding-bottom: 60px;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.8s forwards;
    }
    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    h1, h2, h4 {
      color: #2f4f4f;
    }
    /* Styling untuk carousel */
    .carousel-item img {
      height: 500px;
      object-fit: cover;
    }
    /* Styling untuk search bar dan QR Code section (pada halaman Kartu Anggota) */
    .search-container {
      margin-bottom: 20px;
    }
    .qrcode {
      cursor: pointer;
    }
    .member-photo {
      max-width: 200px;
      margin: 10px;
      border: 2px solid #ddd;
      border-radius: 5px;
      transition: transform 0.3s;
    }
    .member-photo:hover {
      transform: scale(1.05);
    }
    /* Responsive layout untuk tampilan desktop vs. mobile (untuk Kartu Anggota) */
    #anggotaTable, #memberPhotos {
      display: block;
    }
    #anggotaCards {
      display: none;
    }
    @media (max-width: 767px) {
      #anggotaTable, #memberPhotos {
        display: none;
      }
      #anggotaCards {
        display: block;
      }
    }
    /* Styling untuk Contact Form */
    #contactForm {
      max-width: 600px;
      margin: 0 auto;
    }
    #contactForm input, #contactForm textarea {
      transition: border-color 0.3s;
    }
    #contactForm input:focus, #contactForm textarea:focus {
      border-color: #28a745;
    }
    #contactBtn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-success fixed-top">
    <div class="container">
      <a class="navbar-brand" href="index.html">Pecinta Alam</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" 
              aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarContent">
         <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Beranda</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="kegiatan.html">Kegiatan</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="pembelajaran.html">Pembelajaran</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="kartuanggota.html">Kartu Anggota</a>
            </li>
         </ul>
      </div>
    </div>
  </nav>

  <!-- Section: Beranda (Carousel) -->
  <section id="home" class="py-5 mt-5">
    <div class="container">
      <h1 class="display-4 text-center">Selamat Datang di Organisasi Pecinta Alam</h1>
      <p class="lead text-center">Menjelajahi alam, berbagi pengetahuan, dan menjaga keindahan lingkungan.</p>
      <!-- Carousel -->
      <div id="natureCarousel" class="carousel slide mt-4" data-bs-ride="carousel">
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#natureCarousel" data-bs-slide-to="0" class="active"></button>
          <button type="button" data-bs-target="#natureCarousel" data-bs-slide-to="1"></button>
          <button type="button" data-bs-target="#natureCarousel" data-bs-slide-to="2"></button>
        </div>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLm_DL-OfRR3ReSyTh5bT3HaaxV9YRdJaZQQ&s" class="d-block w-100" alt="Pemandangan Alam 1">
          </div>
          <div class="carousel-item">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRky7YwKmakFhhznReQ8JBbQKvKO0LnSY3xAw&s" class="d-block w-100" alt="Pemandangan Alam 2">
          </div>
          <div class="carousel-item">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpt2sDzS3hQJB0g99BS2AtVYrOm6Cg-xkNQKn8Rmr-iJ6Se4V-VL7oXNU&s=10" class="d-block w-100" alt="Pemandangan Alam 3">
          </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#natureCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#natureCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon"></span>
        </button>
      </div>
    </div>
  </section>

  <!-- Section: Informasi Organisasi -->
  <section id="informasi" class="py-5 bg-light">
    <div class="container">
      <h2 class="mb-4">Informasi Organisasi</h2>
      <div class="row">
        <!-- Sejarah -->
        <div class="col-md-6">
          <h4>Sejarah</h4>
          <p>Organisasi Pecinta Alam berdiri sejak tahun 2000 dengan tujuan untuk melestarikan keindahan alam, meningkatkan kesadaran lingkungan, dan mengedukasi masyarakat tentang pentingnya menjaga alam. Sejak berdirinya, organisasi ini telah aktif melakukan berbagai kegiatan eksplorasi, pendakian, dan kegiatan sosial yang berfokus pada konservasi alam.</p>
        </div>
        <!-- Visi & Misi -->
        <div class="col-md-6">
          <h4>Visi &amp; Misi</h4>
          <p><strong>Visi:</strong> Menjadi organisasi terdepan dalam pelestarian dan edukasi lingkungan yang berkelanjutan.</p>
          <p><strong>Misi:</strong></p>
          <ul>
            <li>Meningkatkan kesadaran masyarakat akan pentingnya konservasi alam.</li>
            <li>Mengadakan kegiatan eksplorasi dan pendakian untuk mendekatkan masyarakat dengan alam.</li>
            <li>Menyelenggarakan program edukasi dan pelatihan tentang lingkungan hidup.</li>
            <li>Berkolaborasi dengan berbagai pihak untuk mengembangkan penelitian dan pengabdian kepada masyarakat.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Struktur Kepengurusan (Grafik Organisasi) -->
  <section id="struktur" class="py-5">
    <div class="container">
      <h2 class="mb-4">Struktur Kepengurusan Berjalan</h2>
      <div class="text-center">
        <img id="orgChart" src="grafik-organisasi.png" alt="Grafik Organisasi" class="img-fluid" style="max-width: 80%; cursor: zoom-in;" data-bs-toggle="modal" data-bs-target="#orgModal">
      </div>
    </div>
  </section>

  <!-- Modal untuk tampilan fullscreen grafik organisasi dengan panzoom -->
  <div class="modal fade" id="orgModal" tabindex="-1" aria-labelledby="orgModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
      <div class="modal-content bg-dark">
        <div class="modal-header border-0">
          <h5 class="modal-title text-white" id="orgModalLabel">Grafik Organisasi</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <img id="orgModalImage" src="grafik-organisasi.png" alt="Grafik Organisasi" class="img-fluid" style="cursor: zoom-in;">
        </div>
      </div>
    </div>
  </div>

  <!-- Section: Tanya Jawab (FAQ) menggunakan Accordion Bootstrap -->
  <section id="faq" class="py-5 bg-light">
    <div class="container">
      <h2 class="mb-4">Tanya Jawab</h2>
      <div class="accordion" id="faqAccordion">
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
              Q: Apa tujuan utama organisasi ini?
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#faqAccordion">
            <div class="accordion-body">
              A: Tujuan utama organisasi adalah untuk melestarikan keindahan alam, mengedukasi masyarakat tentang lingkungan, dan meningkatkan kesadaran akan pentingnya konservasi alam.
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingTwo">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              Q: Bagaimana cara bergabung dengan organisasi?
            </button>
          </h2>
          <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#faqAccordion">
            <div class="accordion-body">
              A: Anda dapat menghubungi kami melalui halaman kontak atau langsung datang ke kantor pusat untuk informasi lebih lanjut.
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="headingThree">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
              Q: Apakah ada biaya pendaftaran?
            </button>
          </h2>
          <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#faqAccordion">
            <div class="accordion-body">
              A: Tidak, keanggotaan bersifat gratis namun kami menghimbau partisipasi aktif dalam setiap kegiatan yang diselenggarakan.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section: Video Profil -->
  <section id="video-profil" class="py-5">
    <div class="container">
      <h2 class="mb-4 text-center">Video Profil</h2>
      <div class="ratio ratio-16x9">
        <iframe src="https://www.youtube.com/embed/OyZJOJPpeYQ?autoplay=1&mute=1&loop=1&playlist=OyZJOJPpeYQ" 
                title="Video Profil" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
    </div>
  </section>

  <!-- Section: Contact (Form Kontak) -->
  <section id="contact" class="py-5 bg-light">
    <div class="container">
      <h2 class="mb-4 text-center">Hubungi Kami</h2>
      <form id="contactForm">
        <div class="mb-3">
          <label for="contactName" class="form-label">Nama</label>
          <input type="text" class="form-control" id="contactName" placeholder="Masukkan nama Anda">
        </div>
        <div class="mb-3">
          <label for="contactMessage" class="form-label">Pesan</label>
          <textarea class="form-control" id="contactMessage" rows="4" placeholder="Tulis pesan Anda di sini"></textarea>
        </div>
        <div class="text-center">
          <button type="button" id="contactBtn" class="btn btn-success" disabled>Kirim</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-success text-white py-4">
    <div class="container text-center">
      <p>&copy; 2025 Organisasi Pecinta Alam. All rights reserved.</p>
    </div>
  </footer>

  <!-- Firebase, QRCode, and Panzoom Integration -->
  <script type="module">
    // Import Firebase modules
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBe-XLmVRiMs844VxR1_awMzGEGARb6Xmk",
      authDomain: "website-mpn-65e8d.firebaseapp.com",
      projectId: "website-mpn-65e8d",
      storageBucket: "website-mpn-65e8d.firebasestorage.app",
      messagingSenderId: "798271486726",
      appId: "1:798271486726:web:0d0e0178a963804f627c87",
      measurementId: "G-KSVPVC1Z9D"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    // Fungsi untuk mengambil data anggota dari Firestore dan menyusun tabel
    async function loadAnggotaData() {
      const anggotaTableBody = document.getElementById("anggotaTableBody");
      anggotaTableBody.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "anggota"));
      querySnapshot.forEach(doc => {
        const data = doc.data();
        const row = document.createElement("tr");
        row.setAttribute("data-namalengkap", data.namalengkap.toLowerCase());
        row.setAttribute("data-namalapangan", data.namalapangan.toLowerCase());
        row.setAttribute("data-namaangkatan", data.namaangkatan.toLowerCase());
        row.setAttribute("data-tahun", data.tahun.toString().toLowerCase());
        row.setAttribute("data-nomorregistrasi", data.nomorregistrasi.toLowerCase());
        row.setAttribute("data-keanggotaan", data.keanggotaan.toLowerCase());
        row.setAttribute("data-foto", data.foto);
        row.innerHTML = `
          <td>${data.namalengkap}</td>
          <td>${data.namalapangan}</td>
          <td>${data.namaangkatan}</td>
          <td>${data.tahun}</td>
          <td>${data.nomorregistrasi}</td>
          <td>${data.keanggotaan}</td>
          <td>
            <a href="${data.link}" target="_blank">
              <canvas id="qr-${data.nomorregistrasi}" class="qrcode"></canvas>
            </a>
          </td>
        `;
        // Sembunyikan baris secara default
        row.style.display = "none";
        anggotaTableBody.appendChild(row);
      });
      generateQRCodes();
    }

    // Fungsi untuk menghasilkan QR Code pada tampilan desktop
    function generateQRCodes() {
      const rows = document.querySelectorAll("#anggotaTable tbody tr");
      rows.forEach(row => {
        const nomor = row.getAttribute("data-nomorregistrasi");
        const canvasElement = document.getElementById("qr-" + nomor);
        if (canvasElement) {
          QRCode.toCanvas(canvasElement, row.querySelector("a").href, {
            width: 80,
            margin: 1
          }, function (error) {
            if (error) console.error(error);
          });
        }
      });
    }

    // Fungsi untuk memperbarui tampilan foto anggota (desktop)
    function updateMemberPhotos() {
      const rows = document.querySelectorAll("#anggotaTable tbody tr");
      const photoContainer = document.getElementById("memberPhotos");
      photoContainer.innerHTML = "";
      rows.forEach(row => {
        if (row.style.display !== "none") {
          const foto = row.getAttribute("data-foto");
          const nama = row.getAttribute("data-namalengkap");
          const img = document.createElement("img");
          img.src = foto;
          img.alt = "Kartu Anggota " + nama;
          img.className = "member-photo";
          photoContainer.appendChild(img);
        }
      });
    }

    // Fungsi untuk memperbarui tampilan kartu anggota (mobile)
    function updateAnggotaCards() {
      const rows = document.querySelectorAll("#anggotaTable tbody tr");
      const cardContainer = document.getElementById("anggotaCards");
      cardContainer.innerHTML = "";
      rows.forEach(row => {
        if (row.style.display !== "none") {
          const namalengkap = row.getAttribute("data-namalengkap");
          const namalapangan = row.getAttribute("data-namalapangan");
          const namaangkatan = row.getAttribute("data-namaangkatan");
          const tahun = row.getAttribute("data-tahun");
          const nomorregistrasi = row.getAttribute("data-nomorregistrasi");
          const keanggotaan = row.getAttribute("data-keanggotaan");
          const foto = row.getAttribute("data-foto");
          const link = row.querySelector("a").href;

          const card = document.createElement("div");
          card.className = "card mb-3";
          card.innerHTML = `
            <img src="${foto}" class="card-img-top" alt="Kartu Anggota ${namalengkap}">
            <div class="card-body">
              <h5 class="card-title">${namalengkap}</h5>
              <p class="card-text">
                <strong>Lapangan:</strong> ${namalapangan}<br>
                <strong>Angkatan:</strong> ${namaangkatan}<br>
                <strong>Tahun:</strong> ${tahun}<br>
                <strong>Nomor Registrasi:</strong> ${nomorregistrasi}<br>
                <strong>Keanggotaan:</strong> ${keanggotaan}
              </p>
            </div>
            <div class="card-footer">
              <a href="${link}" target="_blank">
                <canvas id="qr-mobile-${nomorregistrasi}" class="qrcode"></canvas>
              </a>
            </div>
          `;
          cardContainer.appendChild(card);
        }
      });
      generateQRCodesMobile();
    }

    // Fungsi untuk menghasilkan QR Code pada tampilan mobile
    function generateQRCodesMobile() {
      const rows = document.querySelectorAll("#anggotaTable tbody tr");
      rows.forEach(row => {
        if (row.style.display !== "none") {
          const nomor = row.getAttribute("data-nomorregistrasi");
          const canvasElement = document.getElementById("qr-mobile-" + nomor);
          if (canvasElement) {
            QRCode.toCanvas(canvasElement, row.querySelector("a").href, {
              width: 80,
              margin: 1
            }, function (error) {
              if (error) console.error(error);
            });
          }
        }
      });
    }

    // Fungsi pencarian yang menyaring data dan memperbarui tampilan desktop & mobile
    function filterTable() {
      const searchType = document.getElementById("searchType").value;
      const query = document.getElementById("searchInput").value.toLowerCase().trim();
      const rows = document.querySelectorAll("#anggotaTable tbody tr");
      
      if (query === "") {
        rows.forEach(row => row.style.display = "none");
        updateMemberPhotos();
        updateAnggotaCards();
        return;
      }
      
      rows.forEach(row => {
        const data = row.getAttribute("data-" + searchType).toLowerCase();
        if (data.includes(query)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
      updateMemberPhotos();
      updateAnggotaCards();
    }

    // Event listeners untuk pencarian dan load data anggota
    document.addEventListener("DOMContentLoaded", () => {
      loadAnggotaData();
      document.getElementById("searchBtn").addEventListener("click", filterTable);
      document.getElementById("searchInput").addEventListener("keyup", filterTable);
    });

    // Contact Form functionality
    function validateContactForm() {
      const nameField = document.getElementById("contactName");
      const messageField = document.getElementById("contactMessage");
      const btn = document.getElementById("contactBtn");
      if(nameField.value.trim() !== "" && messageField.value.trim() !== "") {
        btn.disabled = false;
      } else {
        btn.disabled = true;
      }
    }
    
    function sendContactEmail() {
      const name = document.getElementById("contactName").value.trim();
      const message = document.getElementById("contactMessage").value.trim();
      const subject = encodeURIComponent("Pesan dari Website Mahapala Narotama");
      const body = encodeURIComponent("Nama: " + name + "\nPesan: " + message);
      // Buka mailto: link dengan alamat email tujuan
      window.location.href = "mailto:ukm.mahapala@narotama.ac.id?subject=" + subject + "&body=" + body;
    }
    
    document.addEventListener("DOMContentLoaded", () => {
      // Validasi input contact form
      document.getElementById("contactName").addEventListener("keyup", validateContactForm);
      document.getElementById("contactMessage").addEventListener("keyup", validateContactForm);
      document.getElementById("contactBtn").addEventListener("click", sendContactEmail);
    });
  </script>
  <!-- Pastikan QRCode.js tersedia (CDN non-modular) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <!-- Panzoom JS untuk modal grafik organisasi -->
  <script src="https://unpkg.com/@panzoom/panzoom/dist/panzoom.min.js"></script>
  <!-- Bootstrap Bundle JS (non-module) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
